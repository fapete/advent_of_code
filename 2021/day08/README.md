Fair warning: I am slightly embarrassed that this solution exists and is associated to my name.